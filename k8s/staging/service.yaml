apiVersion: v1
kind: Service
metadata:
  name: hybridphp-staging
  namespace: staging
  labels:
    app: hybridphp
    environment: staging
spec:
  type: ClusterIP
  ports:
  - port: 80
    targetPort: 8080
    protocol: TCP
    name: http
  selector:
    app: hybridphp
    environment: staging
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: hybridphp-staging-config
  namespace: staging
data:
  app.php: |
    <?php
    return [
        'name' => 'HybridPHP Staging',
        'env' => 'staging',
        'debug' => true,
        'url' => 'https://staging.hybridphp.com',
        'timezone' => 'UTC',
    ];
  database.php: |
    <?php
    return [
        'default' => 'mysql',
        'connections' => [
            'mysql' => [
                'driver' => 'mysql',
                'host' => env('DB_HOST', 'localhost'),
                'port' => env('DB_PORT', '3306'),
                'database' => env('DB_DATABASE', 'hybridphp_staging'),
                'username' => env('DB_USERNAME', 'root'),
                'password' => env('DB_PASSWORD', ''),
                'charset' => 'utf8mb4',
                'collation' => 'utf8mb4_unicode_ci',
                'pool' => [
                    'min' => 5,
                    'max' => 20,
                ],
            ],
        ],
    ];
  cache.php: |
    <?php
    return [
        'default' => 'redis',
        'stores' => [
            'redis' => [
                'driver' => 'redis',
                'host' => env('REDIS_HOST', 'localhost'),
                'port' => env('REDIS_PORT', 6379),
                'password' => env('REDIS_PASSWORD', null),
                'database' => 0,
                'pool' => [
                    'min' => 5,
                    'max' => 20,
                ],
            ],
        ],
    ];
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: hybridphp-staging-storage
  namespace: staging
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi
  storageClassName: fast-ssd